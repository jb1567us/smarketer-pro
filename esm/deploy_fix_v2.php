<?php
$data = "PD9waHANCnJlcXVpcmVfb25jZSgnd3AtbG9hZC5waHAnKTsNCmluaV9zZXQoJ2Rpc3BsYXlfZXJyb3JzJywgMSk7DQplcnJvcl9yZXBvcnRpbmcoRV9BTEwpOw0KDQplY2hvICI8cHJlPkZpeGluZyBNYXJrdXAgVjIgKEpTT04gT25seSkuLi48YnI+IjsNCg0KLy8gR2V0IGFsbCBwYWdlcyBhZ2Fpbg0KJGFyZ3MgPSBbJ3Bvc3RfdHlwZScgPT4gJ3BhZ2UnLCAncG9zdHNfcGVyX3BhZ2UnID0+IC0xLCAncG9zdF9zdGF0dXMnID0+ICdwdWJsaXNoJ107DQokcXVlcnkgPSBuZXcgV1BfUXVlcnkoJGFyZ3MpOw0KDQokY291bnQgPSAwOw0KZm9yZWFjaCAoJHF1ZXJ5LT5wb3N0cyBhcyAkcG9zdCkgew0KICAgICRjb250ZW50ID0gJHBvc3QtPnBvc3RfY29udGVudDsNCiAgICAkb3JpZ2luYWxfY29udGVudCA9ICRjb250ZW50Ow0KICAgICRwaWQgPSAkcG9zdC0+SUQ7DQoNCiAgICAvLyBDaGVjayBpZiBKU09OIGV4aXN0cyBidXQgc2NyaXB0IHRhZyBpcyBtaXNzaW5nDQogICAgaWYgKHN0cnBvcygkY29udGVudCwgJ3sgIkBjb250ZXh0IicpICE9PSBmYWxzZSAmJiBzdHJwb3MoJGNvbnRlbnQsICc8c2NyaXB0IHR5cGU9ImFwcGxpY2F0aW9uL2xkK2pzb24iPnsgIkBjb250ZXh0IicpID09PSBmYWxzZSkgew0KDQogICAgICAgIC8vIFBhdHRlcm46IE1hdGNoIHsgIkBjb250ZXh0IiB1bnRpbCB0aGUgY2xvc2luZyBicmFjZSB9DQogICAgICAgIC8vIFRoZSBzdHJ1Y3R1cmUgZnJvbSBkZWJ1ZyBpczogeyAiQGNvbnRleHQiOiAuLi4gInByaWNlQ3VycmVuY3kiOiAiVVNEIiB9IH0gPGRpdiBjbGFzcz0iYXJ0d29yay1wYWdlLWNvbnRhaW5lciI+DQogICAgICAgIC8vIEl0IGVuZHMgd2l0aCBUV08gYnJhY2VzLiB9fSA8ZGl2DQogICAgICAgIC8vIExldCdzIG1hdGNoOiAoeyAiQGNvbnRleHQiLio/fSlccyooPz08ZGl2IGNsYXNzPSJhcnR3b3JrLXBhZ2UtY29udGFpbmVyIj4pDQoNCiAgICAgICAgLy8gSSdsbCBiZSBzYWZlcjogbWF0Y2ggdW50aWwgdGhlIFNQRUNJRklDIGtub3duIGRpdiBjbGFzcyBzdGFydC4NCiAgICAgICAgJHBhdHRlcm4gPSAnLyhceyAiQGNvbnRleHQiLio/XH0pXHMqKD89PGRpdiBjbGFzcz0iYXJ0d29yay1wYWdlLWNvbnRhaW5lciI+KS9zJzsNCg0KICAgICAgICBpZiAocHJlZ19tYXRjaCgkcGF0dGVybiwgJGNvbnRlbnQsICRtKSkgew0KICAgICAgICAgICAgLy8gZWNobyAiREVCVUc6IE1hdGNoIGZvdW5kIGZvciBQYWdlICRwaWQ6ICIgLiBodG1sc3BlY2lhbGNoYXJzKHN1YnN0cigkbVswXSwgMCwgNTApKSAuICIuLi48YnI+IjsNCiAgICAgICAgICAgICRjb250ZW50ID0gcHJlZ19yZXBsYWNlKCRwYXR0ZXJuLCAnPHNjcmlwdCB0eXBlPSJhcHBsaWNhdGlvbi9sZCtqc29uIj4kMTwvc2NyaXB0PicsICRjb250ZW50KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIERlYnVnIHdoeSBpdCBmYWlsZWQ/IA0KICAgICAgICAgICAgLy8gTWF5YmUgd2hpdGVzcGFjZSBpcyB0cmlja3kuDQogICAgICAgICAgICAvLyBUcnkgbG9vc2VyIG1hdGNoDQogICAgICAgICAgICAkcGF0dGVybl9sb29zZSA9ICcvKFx7ICJAY29udGV4dCIuKj9cfSlccyooPz08ZGl2KS9zJzsNCiAgICAgICAgICAgIGlmIChwcmVnX21hdGNoKCRwYXR0ZXJuX2xvb3NlLCAkY29udGVudCkpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9IHByZWdfcmVwbGFjZSgkcGF0dGVybl9sb29zZSwgJzxzY3JpcHQgdHlwZT0iYXBwbGljYXRpb24vbGQranNvbiI+JDE8L3NjcmlwdD4nLCAkY29udGVudCk7DQogICAgICAgICAgICAgICAgLy8gZWNobyAiREVCVUc6IExvb3NlIE1hdGNoIGZvdW5kIGZvciBQYWdlICRwaWQ8YnI+IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICgkY29udGVudCAhPT0gJG9yaWdpbmFsX2NvbnRlbnQpIHsNCiAgICAgICAgd3BfdXBkYXRlX3Bvc3QoWydJRCcgPT4gJHBpZCwgJ3Bvc3RfY29udGVudCcgPT4gJGNvbnRlbnRdKTsNCiAgICAgICAgZWNobyAi4pyFIEZpeGVkIEpTT04gZm9yIFBhZ2UgJHBpZDxicj4iOw0KICAgICAgICAkY291bnQrKzsNCiAgICB9DQp9DQplY2hvICJVcGRhdGVkICRjb3VudCBwYWdlcy48L3ByZT4iOw0KPz4=";
$decoded = base64_decode($data);
if (file_put_contents(__DIR__ . '/run_fix_v2.php', $decoded)) {
    echo "✅ Successfully deployed run_fix_v2.php (" . strlen($decoded) . " bytes)";
} else {
    echo "❌ Failed to write run_fix_v2.php";
}
?>