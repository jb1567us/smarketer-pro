<?php
$data = "PD9waHANCnJlcXVpcmVfb25jZSgnd3AtbG9hZC5waHAnKTsNCmluaV9zZXQoJ2Rpc3BsYXlfZXJyb3JzJywgMSk7DQplcnJvcl9yZXBvcnRpbmcoRV9BTEwpOw0KDQpnbG9iYWwgJHdwZGI7DQoNCmVjaG8gIjxwcmU+Rml4aW5nIE1hcmt1cCB2aWEgRGlyZWN0IFNRTCAoRm9yY2UpLi4uPGJyPiI7DQoNCi8vIEdldCBhbGwgcGFnZXMgZGlyZWN0bHkgZnJvbSBEQiB0byBhdm9pZCBhbnkgY2FjaGluZw0KJHBvc3RzID0gJHdwZGItPmdldF9yZXN1bHRzKCJTRUxFQ1QgSUQsIHBvc3RfY29udGVudCBGUk9NICR3cGRiLT5wb3N0cyBXSEVSRSBwb3N0X3R5cGU9J3BhZ2UnIEFORCBwb3N0X3N0YXR1cz0ncHVibGlzaCciKTsNCg0KJGNvdW50ID0gMDsNCmZvcmVhY2ggKCRwb3N0cyBhcyAkcG9zdCkgew0KICAgICRjb250ZW50ID0gJHBvc3QtPnBvc3RfY29udGVudDsNCiAgICAkb3JpZ2luYWxfY29udGVudCA9ICRjb250ZW50Ow0KICAgICRwaWQgPSAkcG9zdC0+SUQ7DQogICAgJGNoYW5nZWQgPSBmYWxzZTsNCg0KICAgIC8vIDEuIEZJWCBDU1MNCiAgICBpZiAoc3RycG9zKCRjb250ZW50LCAnLyogRm9udCBJbXBvcnRzICovJykgIT09IGZhbHNlICYmIHN0cnBvcygkY29udGVudCwgJzxzdHlsZT4vKiBGb250IEltcG9ydHMgKi8nKSA9PT0gZmFsc2UpIHsNCiAgICAgICAgJHBhdHRlcm5fY3NzID0gJy8oXC9cKiBGb250IEltcG9ydHMgXCpcLy4qPylccyooPz08IS0tIFZpc3VhbEFydHdvcmsgU2NoZW1hIC0tPikvcyc7DQogICAgICAgIGlmIChwcmVnX21hdGNoKCRwYXR0ZXJuX2NzcywgJGNvbnRlbnQpKSB7DQogICAgICAgICAgICAkY29udGVudCA9IHByZWdfcmVwbGFjZSgkcGF0dGVybl9jc3MsICI8c3R5bGU+JDE8L3N0eWxlPiIsICRjb250ZW50KTsNCiAgICAgICAgICAgICRjaGFuZ2VkID0gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIDIuIEZJWCBKU09OIChBbmNob3IgU3RyYXRlZ3kpDQogICAgJG1hcmtlciA9ICc8IS0tIFZpc3VhbEFydHdvcmsgU2NoZW1hIC0tPic7DQogICAgJG1hcmtlcl9wb3MgPSBzdHJwb3MoJGNvbnRlbnQsICRtYXJrZXIpOw0KDQogICAgaWYgKCRtYXJrZXJfcG9zICE9PSBmYWxzZSkgew0KICAgICAgICAvLyBDaGVjayBpZiBhbHJlYWR5IHdyYXBwZWQNCiAgICAgICAgJHNuaXBwZXQgPSBzdWJzdHIoJGNvbnRlbnQsICRtYXJrZXJfcG9zLCAyMDApOw0KICAgICAgICBpZiAoc3RycG9zKCRzbmlwcGV0LCAnPHNjcmlwdCcpID09PSBmYWxzZSkgew0KICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBKU09ODQogICAgICAgICAgICAkanNvbl9zdGFydCA9IHN0cnBvcygkY29udGVudCwgJ3snLCAkbWFya2VyX3Bvcyk7DQogICAgICAgICAgICBpZiAoJGpzb25fc3RhcnQgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgKGJlZm9yZSBkaXYpDQogICAgICAgICAgICAgICAgJGRpdl9wb3MgPSBzdHJwb3MoJGNvbnRlbnQsICc8ZGl2IGNsYXNzPSJhcnR3b3JrLXBhZ2UtY29udGFpbmVyIicsICRqc29uX3N0YXJ0KTsNCiAgICAgICAgICAgICAgICAvLyBGYWxsYmFjaw0KICAgICAgICAgICAgICAgIGlmICgkZGl2X3BvcyA9PT0gZmFsc2UpDQogICAgICAgICAgICAgICAgICAgICRkaXZfcG9zID0gc3RycG9zKCRjb250ZW50LCAnPGRpdicsICRqc29uX3N0YXJ0KTsNCg0KICAgICAgICAgICAgICAgIGlmICgkZGl2X3BvcyAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgJHJhd19ibG9jayA9IHN1YnN0cigkY29udGVudCwgJGpzb25fc3RhcnQsICRkaXZfcG9zIC0gJGpzb25fc3RhcnQpOw0KICAgICAgICAgICAgICAgICAgICAkanNvbl9jbGVhbiA9IHRyaW0oJHJhd19ibG9jayk7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gU2FuaXR5IGNoZWNrDQogICAgICAgICAgICAgICAgICAgIGlmIChzdWJzdHIoJGpzb25fY2xlYW4sIDAsIDEpID09ICd7JyAmJiBzdWJzdHIoJGpzb25fY2xlYW4sIC0xKSA9PSAnfScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR3cmFwcGVkID0gJzxzY3JpcHQgdHlwZT0iYXBwbGljYXRpb24vbGQranNvbiI+JyAuICRqc29uX2NsZWFuIC4gJzwvc2NyaXB0Pic7DQogICAgICAgICAgICAgICAgICAgICAgICAkYmVmb3JlID0gc3Vic3RyKCRjb250ZW50LCAwLCAkanNvbl9zdGFydCk7DQogICAgICAgICAgICAgICAgICAgICAgICAkYWZ0ZXIgPSBzdWJzdHIoJGNvbnRlbnQsICRkaXZfcG9zKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICRjb250ZW50ID0gJGJlZm9yZSAuICR3cmFwcGVkIC4gJGFmdGVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgJGNoYW5nZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gMy4gU1FMIFVQREFURQ0KICAgIGlmICgkY2hhbmdlZCAmJiAkY29udGVudCAhPT0gJG9yaWdpbmFsX2NvbnRlbnQpIHsNCiAgICAgICAgJHJlc3VsdCA9ICR3cGRiLT51cGRhdGUoDQogICAgICAgICAgICAkd3BkYi0+cG9zdHMsDQogICAgICAgICAgICBbJ3Bvc3RfY29udGVudCcgPT4gJGNvbnRlbnRdLA0KICAgICAgICAgICAgWydJRCcgPT4gJHBpZF0NCiAgICAgICAgKTsNCg0KICAgICAgICBpZiAoJHJlc3VsdCAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIGVjaG8gIuKchSBTUUwgVVBEQVRFRCBQYWdlICRwaWQ8YnI+IjsNCiAgICAgICAgICAgICRjb3VudCsrOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZWNobyAi4p2MIFNRTCBFUlIgUGFnZSAkcGlkOiAiIC4gJHdwZGItPmxhc3RfZXJyb3IgLiAiPGJyPiI7DQogICAgICAgIH0NCiAgICB9DQp9DQplY2hvICJVcGRhdGVkICRjb3VudCBwYWdlcyB2aWEgU1FMLjwvcHJlPiI7DQo/Pg==";
$decoded = base64_decode($data);
if (file_put_contents(__DIR__ . '/run_fix_sql.php', $decoded)) {
    echo "✅ Successfully deployed run_fix_sql.php (" . strlen($decoded) . " bytes)";
} else {
    echo "❌ Failed to write run_fix_sql.php";
}
?>