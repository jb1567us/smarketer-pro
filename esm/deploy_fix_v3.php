<?php
$data = "PD9waHANCnJlcXVpcmVfb25jZSgnd3AtbG9hZC5waHAnKTsNCmluaV9zZXQoJ2Rpc3BsYXlfZXJyb3JzJywgMSk7DQplcnJvcl9yZXBvcnRpbmcoRV9BTEwpOw0KDQplY2hvICI8cHJlPkZpeGluZyBNYXJrdXAgVjMgKEFuY2hvciBTdHJhdGVneSkuLi48YnI+IjsNCg0KLy8gR2V0IGFsbCBwYWdlcw0KJGFyZ3MgPSBbJ3Bvc3RfdHlwZScgPT4gJ3BhZ2UnLCAncG9zdHNfcGVyX3BhZ2UnID0+IC0xLCAncG9zdF9zdGF0dXMnID0+ICdwdWJsaXNoJ107DQokcXVlcnkgPSBuZXcgV1BfUXVlcnkoJGFyZ3MpOw0KDQokY291bnQgPSAwOw0KZm9yZWFjaCAoJHF1ZXJ5LT5wb3N0cyBhcyAkcG9zdCkgew0KICAgICRjb250ZW50ID0gJHBvc3QtPnBvc3RfY29udGVudDsNCiAgICAkb3JpZ2luYWxfY29udGVudCA9ICRjb250ZW50Ow0KICAgICRwaWQgPSAkcG9zdC0+SUQ7DQoNCiAgICAvLyBEZWJ1ZyBzcGVjaWZpYyBwYWdlDQogICAgaWYgKCRwaWQgPT0gMTkyNykgew0KICAgICAgICAvLyBlY2hvICJERUJVRyBQYWdlIDE5MjcgY29udGVudCBsZW5ndGg6ICIgLiBzdHJsZW4oJGNvbnRlbnQpIC4gIjxicj4iOw0KICAgIH0NCg0KICAgIC8vIENoZWNrIGlmIEpTT04gZXhpc3RzIGJ1dCBzY3JpcHQgdGFnIGlzIG1pc3NpbmcNCiAgICAvLyBXZSBsb29rIGZvciB0aGUgQ09NTUVOVCBtYXJrZXIgd2hpY2ggaXMgcmVsaWFibGUNCiAgICAkbWFya2VyID0gJzwhLS0gVmlzdWFsQXJ0d29yayBTY2hlbWEgLS0+JzsNCiAgICAkbWFya2VyX3BvcyA9IHN0cnBvcygkY29udGVudCwgJG1hcmtlcik7DQoNCiAgICBpZiAoJG1hcmtlcl9wb3MgIT09IGZhbHNlKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGFscmVhZHkgd3JhcHBlZD8NCiAgICAgICAgLy8gTG9vayBhaGVhZCBmb3IgPHNjcmlwdD4NCiAgICAgICAgJHNuaXBwZXQgPSBzdWJzdHIoJGNvbnRlbnQsICRtYXJrZXJfcG9zLCA1MCk7DQogICAgICAgIGlmIChzdHJwb3MoJHNuaXBwZXQsICc8c2NyaXB0JykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAvLyBBbHJlYWR5IHdyYXBwZWQ/DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgSlNPTiAoZmlyc3QgeyBhZnRlciBtYXJrZXIpDQogICAgICAgICRqc29uX3N0YXJ0ID0gc3RycG9zKCRjb250ZW50LCAneycsICRtYXJrZXJfcG9zKTsNCiAgICAgICAgaWYgKCRqc29uX3N0YXJ0ID09PSBmYWxzZSkNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KDQogICAgICAgIC8vIEZpbmQgZW5kIG9mIEpTT04gKGxvb2sgZm9yIDxkaXYgd2hpY2ggc3RhcnRzIHRoZSBuZXh0IHNlY3Rpb24pDQogICAgICAgICRkaXZfcG9zID0gc3RycG9zKCRjb250ZW50LCAnPGRpdiBjbGFzcz0iYXJ0d29yay1wYWdlLWNvbnRhaW5lciInLCAkanNvbl9zdGFydCk7DQogICAgICAgIGlmICgkZGl2X3BvcyA9PT0gZmFsc2UpIHsNCiAgICAgICAgICAgIC8vIFRyeSBnZW5lcmljIGRpdg0KICAgICAgICAgICAgJGRpdl9wb3MgPSBzdHJwb3MoJGNvbnRlbnQsICc8ZGl2JywgJGpzb25fc3RhcnQpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRkaXZfcG9zICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgLy8gVmVyaWZ5IHRoZXJlIGlzIGEgY2xvc2luZyBicmFjZSBiZWZvcmUgdGhlIGRpdg0KICAgICAgICAgICAgLy8gV2UgdGFrZSBldmVyeXRoaW5nIGZyb20gJGpzb25fc3RhcnQgdG8gJGRpdl9wb3MNCiAgICAgICAgICAgICRyYXdfYmxvY2sgPSBzdWJzdHIoJGNvbnRlbnQsICRqc29uX3N0YXJ0LCAkZGl2X3BvcyAtICRqc29uX3N0YXJ0KTsNCiAgICAgICAgICAgIC8vIFRyaW0gaXQNCiAgICAgICAgICAgICRqc29uX2NsZWFuID0gdHJpbSgkcmF3X2Jsb2NrKTsNCg0KICAgICAgICAgICAgLy8gT25seSB3cmFwIGlmIGl0IGxvb2tzIGxpa2UgSlNPTg0KICAgICAgICAgICAgaWYgKHN1YnN0cigkanNvbl9jbGVhbiwgMCwgMSkgPT0gJ3snICYmIHN1YnN0cigkanNvbl9jbGVhbiwgLTEpID09ICd9Jykgew0KICAgICAgICAgICAgICAgICR3cmFwcGVkID0gJzxzY3JpcHQgdHlwZT0iYXBwbGljYXRpb24vbGQranNvbiI+JyAuICRqc29uX2NsZWFuIC4gJzwvc2NyaXB0Pic7DQogICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgcmF3IGJsb2NrIGluIHRoZSBjb250ZW50DQogICAgICAgICAgICAgICAgLy8gQmUgY2FyZWZ1bCB3aXRoIGV4YWN0IHBvc2l0aW9uDQogICAgICAgICAgICAgICAgJGJlZm9yZSA9IHN1YnN0cigkY29udGVudCwgMCwgJGpzb25fc3RhcnQpOw0KICAgICAgICAgICAgICAgICRhZnRlciA9IHN1YnN0cigkY29udGVudCwgJGRpdl9wb3MpOw0KDQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkYmVmb3JlIC4gJHdyYXBwZWQgLiAkYWZ0ZXI7DQogICAgICAgICAgICAgICAgLy8gZWNobyAi4pyFIFdyYXBwZWQgSlNPTiBmb3IgUGFnZSAkcGlkPGJyPiI7DQoNCiAgICAgICAgICAgICAgICBpZiAoJGNvbnRlbnQgIT09ICRvcmlnaW5hbF9jb250ZW50KSB7DQogICAgICAgICAgICAgICAgICAgIHdwX3VwZGF0ZV9wb3N0KFsnSUQnID0+ICRwaWQsICdwb3N0X2NvbnRlbnQnID0+ICRjb250ZW50XSk7DQogICAgICAgICAgICAgICAgICAgIGVjaG8gIuKchSBGSVggQVBQTElFRCBQYWdlICRwaWQ8YnI+IjsNCiAgICAgICAgICAgICAgICAgICAgJGNvdW50Kys7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoJHBpZCA9PSAxOTI3KQ0KICAgICAgICAgICAgICAgICAgICBlY2hvICLimqDvuI8gUGFnZSAxOTI3IEpTT04gYmxvY2sgbWFsZm9ybWVkOiAiIC4gaHRtbHNwZWNpYWxjaGFycygkanNvbl9jbGVhbikgLiAiPGJyPiI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQplY2hvICJVcGRhdGVkICRjb3VudCBwYWdlcy48L3ByZT4iOw0KPz4=";
$decoded = base64_decode($data);
if (file_put_contents(__DIR__ . '/run_fix_v3.php', $decoded)) {
    echo "✅ Successfully deployed run_fix_v3.php (" . strlen($decoded) . " bytes)";
} else {
    echo "❌ Failed to write run_fix_v3.php";
}
?>